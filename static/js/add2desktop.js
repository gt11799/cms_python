var gmu=gmu||{version:"@version",$:window.Zepto,staticCall:function($){var proto=$.fn,slice=[].slice,instance=$();return instance.length=1,function(item,fn){return instance[0]=item,proto[fn].apply(instance,slice.call(arguments,2))}}(Zepto)};(function($,undefined){$.extend($.fn,{fix:function(opts){var me=this;if(me.attr("isFixed"))return me;me.css(opts).css("position","fixed").attr("isFixed",!0);var buff=$('<div style="position:fixed;top:10px;"></div>').appendTo("body"),top=buff[0].getBoundingClientRect().top,checkFixed=function(){window.pageYOffset>0&&(buff[0].getBoundingClientRect().top!==top&&(me.css("position","absolute"),doFixed(),$(window).on("scrollStop",doFixed),$(window).on("ortchange",doFixed)),$(window).off("scrollStop",checkFixed),buff.remove())},doFixed=function(){me.css({top:window.pageYOffset+(opts.bottom!==undefined?window.innerHeight-me.height()-opts.bottom:opts.top||0),left:opts.right!==undefined?document.body.offsetWidth-me.width()-opts.right:opts.left||0}),opts.width=="100%"&&me.css("width",document.body.offsetWidth)};return $(window).on("scrollStop",checkFixed),me}})})(Zepto),function(gmu,$){function eachEvent(events,callback,iterator){(events||"").split(separator).forEach(function(type){iterator(type,callback)})}function matcherFor(ns){return new RegExp("(?:^| )"+ns.replace(" "," .* ?")+"(?: |$)")}function parse(name){var parts=(""+name).split(".");return{e:parts[0],ns:parts.slice(1).sort().join(" ")}}function findHandlers(arr,name,callback,context){var matcher,obj;return obj=parse(name),obj.ns&&(matcher=matcherFor(obj.ns)),arr.filter(function(handler){return handler&&(!obj.e||handler.e===obj.e)&&(!obj.ns||matcher.test(handler.ns))&&(!callback||handler.cb===callback||handler.cb._cb===callback)&&(!context||handler.ctx===context)})}function Event(type,props){return this instanceof Event?(props&&$.extend(this,props),this.type=type,this):new Event(type,props)}var slice=[].slice,separator=/\s+/,returnFalse=function(){return!1},returnTrue=function(){return!0};Event.prototype={isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,preventDefault:function(){this.isDefaultPrevented=returnTrue},stopPropagation:function(){this.isPropagationStopped=returnTrue}},gmu.event={on:function(name,callback,context){var me=this,set;return callback?(set=this._events||(this._events=[]),eachEvent(name,callback,function(name,callback){var handler=parse(name);handler.cb=callback,handler.ctx=context,handler.ctx2=context||me,handler.id=set.length,set.push(handler)}),this):this},one:function(name,callback,context){var me=this;return callback?(eachEvent(name,callback,function(name,callback){var once=function(){return me.off(name,once),callback.apply(context||me,arguments)};once._cb=callback,me.on(name,once,context)}),this):this},off:function(name,callback,context){var events=this._events;return events?!name&&!callback&&!context?(this._events=[],this):(eachEvent(name,callback,function(name,callback){findHandlers(events,name,callback,context).forEach(function(handler){delete events[handler.id]})}),this):this},trigger:function(evt){var i=-1,args,events,stoped,len,ev;if(!this._events||!evt)return this;typeof evt=="string"&&(evt=new Event(evt)),args=slice.call(arguments,1),evt.args=args,args.unshift(evt),events=findHandlers(this._events,evt.type);if(events){len=events.length;while(++i<len)if((stoped=evt.isPropagationStopped())||!1===(ev=events[i]).cb.apply(ev.ctx2,args)){stoped||(evt.stopPropagation(),evt.preventDefault());break}}return this}},gmu.Event=Event}(gmu,gmu.$),function(gmu,$,undefined){function isPlainObject(obj){return toString.call(obj)==="[object Object]"}function eachObject(obj,iterator){obj&&Object.keys(obj).forEach(function(key){iterator(key,obj[key])})}function parseData(data){try{data=data==="true"?!0:data==="false"?!1:data==="null"?null:+data+""===data?+data:/(?:\{[\s\S]*\}|\[[\s\S]*\])$/.test(data)?JSON.parse(data):data}catch(ex){data=undefined}return data}function getDomOptions(el){var ret={},attrs=el&&el.attributes,len=attrs&&attrs.length,key,data;while(len--){data=attrs[len],key=data.name;if(key.substring(0,5)!=="data-")continue;key=key.substring(5),data=parseData(data.value),data===undefined||(ret[key]=data)}return ret}function zeptolize(name){var key=name.substring(0,1).toLowerCase()+name.substring(1),old=$.fn[key];$.fn[key]=function(opts){var args=slice.call(arguments,1),method=typeof opts=="string"&&opts,ret,obj;return $.each(this,function(i,el){obj=record(el,name)||new gmu[name](el,isPlainObject(opts)?opts:undefined);if(method==="this")return ret=obj,!1;if(method){if(!$.isFunction(obj[method]))throw new Error("缁勪欢娌℃湁姝ゆ柟娉曪細"+method);ret=obj[method].apply(obj,args);if(ret!==undefined&&ret!==obj)return!1;ret=undefined}}),ret!==undefined?ret:this},$.fn[key].noConflict=function(){return $.fn[key]=old,this}}function loadOption(klass,opts){var me=this;klass.superClass&&loadOption.call(me,klass.superClass,opts),eachObject(record(klass,"options"),function(key,option){option.forEach(function(item){var condition=item[0],fn=item[1];(condition==="*"||$.isFunction(condition)&&condition.call(me,opts[key])||condition===opts[key])&&fn.call(me)})})}function loadPlugins(klass,opts){var me=this;klass.superClass&&loadPlugins.call(me,klass.superClass,opts),eachObject(record(klass,"plugins"),function(opt,plugin){if(opts[opt]===!1)return;eachObject(plugin,function(key,val){var oringFn;$.isFunction(val)&&(oringFn=me[key])?me[key]=function(){var origin=me.origin,ret;return me.origin=oringFn,ret=val.apply(me,arguments),origin===undefined?delete me.origin:me.origin=origin,ret}:me[key]=val}),plugin._init.call(me)})}function mergeObj(){var args=slice.call(arguments),i=args.length,last;while(i--)last=last||args[i],isPlainObject(args[i])||args.splice(i,1);return args.length?$.extend.apply(null,[!0,{}].concat(args)):last}function bootstrap(name,klass,uid,el,options){var me=this,opts;return isPlainObject(el)&&(options=el,el=undefined),options&&options.el&&(el=$(options.el)),el&&(me.$el=$(el),el=me.$el[0]),opts=me._options=mergeObj(klass.options,getDomOptions(el),options),me.template=mergeObj(klass.template,opts.template),me.tpl2html=mergeObj(klass.tpl2html,opts.tpl2html),me.widgetName=name.toLowerCase(),me.eventNs="."+me.widgetName+uid,me._init(opts),me._options.setup=me.$el&&me.$el.parent()[0]?!0:!1,loadOption.call(me,klass,opts),loadPlugins.call(me,klass,opts),me._create(),me.trigger("ready"),el&&record(el,name,me)&&me.on("destroy",function(){record(el,name,null)}),me}function createClass(name,object,superClass){function klass(el,options){if(name==="Base")throw new Error("Base绫讳笉鑳界洿鎺ュ疄渚嬪寲");return this instanceof klass?bootstrap.call(this,name,klass,uuid++,el,options):new klass(el,options)}typeof superClass!="function"&&(superClass=gmu.Base);var uuid=1,suid=1;return $.extend(klass,{register:function(name,obj){var plugins=record(klass,"plugins")||record(klass,"plugins",{});return obj._init=obj._init||blankFn,plugins[name]=obj,klass},option:function(option,value,method){var options=record(klass,"options")||record(klass,"options",{});return options[option]||(options[option]=[]),options[option].push([value,method]),klass},inherits:function(obj){return createClass(name+"Sub"+suid++,obj,klass)},extend:function(obj){var proto=klass.prototype,superProto=superClass.prototype;staticlist.forEach(function(item){obj[item]=mergeObj(superClass[item],obj[item]),obj[item]&&(klass[item]=obj[item]),delete obj[item]}),eachObject(obj,function(key,val){typeof val=="function"&&superProto[key]?proto[key]=function(){var $super=this.$super,ret;return this.$super=function(){var args=slice.call(arguments,1);return superProto[key].apply(this,args)},ret=val.apply(this,arguments),$super===undefined?delete this.$super:this.$super=$super,ret}:proto[key]=val})}}),klass.superClass=superClass,klass.prototype=Object.create(superClass.prototype),klass.extend(object),klass}var slice=[].slice,toString=Object.prototype.toString,blankFn=function(){},staticlist=["options","template","tpl2html"],record=function(){var data={},id=0,ikey="_gid";return function(obj,key,val){var dkey=obj[ikey]||(obj[ikey]=++id),store=data[dkey]||(data[dkey]={});return val!==undefined&&(store[key]=val),val===null&&delete store[key],store[key]}}(),event=gmu.event;gmu.define=function(name,object,superClass){gmu[name]=createClass(name,object,superClass),zeptolize(name)},gmu.isWidget=function(obj,klass){return klass=typeof klass=="string"?gmu[klass]||blankFn:klass,klass=klass||gmu.Base,obj instanceof klass},gmu.Base=createClass("Base",{_init:blankFn,_create:blankFn,getEl:function(){return this.$el},on:event.on,one:event.one,off:event.off,trigger:function(name){var evt=typeof name=="string"?new gmu.Event(name):name,args=[evt].concat(slice.call(arguments,1)),opEvent=this._options[evt.type],$el=this.getEl();return opEvent&&$.isFunction(opEvent)&&!1===opEvent.apply(this,args)&&(evt.stopPropagation(),evt.preventDefault()),event.trigger.apply(this,args),$el&&$el.triggerHandler(evt,(args.shift(),args)),this},tpl2html:function(subpart,data){var tpl=this.template;return tpl=typeof subpart=="string"?tpl[subpart]:(data=subpart,tpl),data||~tpl.indexOf("<%")?$.parseTpl(tpl,data):tpl},destroy:function(){this.$el&&this.$el.off(this.eventNs),this.trigger("destroy"),this.off(),this.destroyed=!0}},Object),$.ui=gmu}(gmu,gmu.$),function(gmu,$,undefined){gmu.define("Add2desktop",{options:{icon:"",container:"",key:"_gmu_adddesktop_key",useFix:!0,position:{bottom:12,left:"50%"},beforeshow:function(e){this.key()&&e.preventDefault()},afterhide:function(){this.key(1)},_isShow:!1},_init:function(){var me=this;me.on("ready",function(){me.$el.find(".ui-add2desktop-close").on("click",function(){me.hide()}),me._options.useFix&&me.$el.fix(me._options.position),me.show()}),me.on("destroy",function(){me.$el.remove()})},_create:function(){var me=this,$el,version=$.os.version&&$.os.version.substr(0,3)>4.1?"new":"old";$.os.version&&$.os.version.substr(0,3)>=7&&(version="iOS7");if(me._options.setup){var src=me.$el.children("img").attr("src");src&&(me._options.icon=src)}$el=me.$el||(me.$el=$("<div></div>")),$el.addClass("ui-add2desktop").appendTo(me._options.container||(me.$el.parent().length?"":document.body)),$el.html('<img src="'+me._options.icon+'"/><p>先点击<span class="ui-add2desktop-icon-'+version+'"></span>，<br />再"添加到主屏幕"</p><span class="ui-add2desktop-close"><b></b></span><div class="ui-add2desktop-arrow"><b></b></div>')},key:function(value){var ls=window.localStorage;return value!==undefined?ls.setItem(this._options.key,value):ls.getItem(this._options.key)},show:function(){var me=this;if(!me._options._isShow){if(!$.os.ios||$.browser.uc||$.browser.qq||$.browser.chrome)return me;var event=new gmu.Event("beforeshow");me.trigger(event);if(event.isDefaultPrevented())return me;me.$el.css("display","block"),me._options._isShow=!0}return me},hide:function(){var me=this;return me._options._isShow&&(me.$el.css("display","none"),me._options._isShow=!1,me.trigger("afterhide")),me}})}(gmu,gmu.$)